# PeakDecoder

PeakDecoder is a machine learning-based metabolite identification algorithm for multidimensional mass spectrometry measurements incorporating liquid chromatography (LC) and ion mobility spectrometry (IM) separations, and collecting extensive fragmentation spectra with data-independent acquisition (DIA) methods. The algorithm learns to distinguish true co-elution and co-mobility from raw data and calculates metabolite identification error rates.

### Workflow

* Step-1: data is processed in untargeted mode (using MS-DIAL) to extract all precursor ion features (MS1) and their respective deconvoluted fragment ions (pseudo MS2) based on co-elution and co-mobility. 
* Step-2: a preliminary training set is generated by using the detected and deconvoluted peak-groups as targets and producing their corresponding decoys. 
* Step-3: targeted data extraction is performed (usig Skyline) to extract the precursor and fragment ion signals for the training set from all the LC-IM-MS runs and export their XIC metrics. 
* Step-4: an SVM classifier is trained using multiple scores calculated from the XIC metrics of the training set. Before training, filtering for high-quality fragments is applied to keep high-quality peak-groups as targets (i.e., based on various thresholds for metrics of precursor and at least 3 fragments: S/N, mass error, RT difference to precursor, and FWHM difference to precursor; details in Methods) and their corresponding decoys in the final training set. The model learns to distinguish true and false co-elution and co-mobility, independently of the featuresâ€™ metabolite identity. 
* Step-5: TDX is performed to extract the signals of the query set of metabolites in the library from all the LC-IM-MS runs and export their XIC metrics. 
* Step-6: the trained model is used to determine the PeakDecoder score of the query set of metabolites and estimate an FDR.


### Data

The 3 subfolder contain input and output files to run the PeakDecoder steps for the synthetic biology datasets:
* Asper: *Aspergillus pseudoterreus* and *Aspergillus niger* strains
* Pput: *Pseudomonas putida* strains
* Rhodo: *Rhodosporidium toruloides* strains

### Contact

aivett.bilbao@pnnl.gov

### Reference

If you use PeakDecoder or any portions of this code please cite: Bilbao et al. "PeakDecoder enables machine learning-based metabolite identification and accurate profiling in multidimensional mass spectrometry measurements". Submitted.
